{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://floweb.com/schemas/action-configs.json",
  "title": "Action Configurations",
  "description": "Configuration schemas for all automation actions",
  "type": "object",
  "properties": {
    "action_configs": {
      "type": "object",
      "patternProperties": {
        ".*": {
          "oneOf": [
            {
              "$ref": "#/$defs/ClickConfig"
            },
            {
              "$ref": "#/$defs/InputConfig"
            },
            {
              "$ref": "#/$defs/SendKeysConfig"
            },
            {
              "$ref": "#/$defs/WaitConfig"
            },
            {
              "$ref": "#/$defs/NavigateConfig"
            },
            {
              "$ref": "#/$defs/ScrollConfig"
            },
            {
              "$ref": "#/$defs/ScreenshotConfig"
            },
            {
              "$ref": "#/$defs/AssertionConfig"
            },
            {
              "$ref": "#/$defs/AssertVisibleConfig"
            },
            {
              "$ref": "#/$defs/FormFillConfig"
            },
            {
              "$ref": "#/$defs/ClearInputConfig"
            },
            {
              "$ref": "#/$defs/OpenNewTabConfig"
            },
            {
              "$ref": "#/$defs/SwitchTabConfig"
            },
            {
              "$ref": "#/$defs/GoForwardConfig"
            },
            {
              "$ref": "#/$defs/GoBackConfig"
            },
            {
              "$ref": "#/$defs/RefreshConfig"
            },
            {
              "$ref": "#/$defs/GetPageInfoConfig"
            },
            {
              "$ref": "#/$defs/JunctionConfig"
            },
            {
              "$ref": "#/$defs/ApiCallConfig"
            },
            {
              "$ref": "#/$defs/ConditionalConfig"
            },
            {
              "$ref": "#/$defs/LoopConfig"
            },
            {
              "$ref": "#/$defs/DatabaseQueryConfig"
            },
            {
              "$ref": "#/$defs/DatabaseInsertConfig"
            },
            {
              "$ref": "#/$defs/CustomCodeConfig"
            },
            {
              "$ref": "#/$defs/DragAndDropConfig"
            },
            {
              "$ref": "#/$defs/CallToFlowConfig"
            },
            {
              "$ref": "#/$defs/SwitchToFrameConfig"
            },
            {
              "$ref": "#/$defs/ExitFrameConfig"
            },
            {
              "$ref": "#/$defs/SetViewportConfig"
            },
            {
              "$ref": "#/$defs/GetElementPropertiesConfig"
            },
            {
              "$ref": "#/$defs/HandlePopupConfig"
            },
            {
              "$ref": "#/$defs/FileUploadConfig"
            },
            {
              "$ref": "#/$defs/FileDownloadConfig"
            },
            {
              "$ref": "#/$defs/SubflowConfig"
            }
          ]
        }
      }
    }
  },
  "$defs": {
    "BaseActionConfig": {
      "type": "object",
      "properties": {
        "image": {
          "type": "string",
          "description": "Base64 encoded reference image"
        }
      }
    },
    "ClickConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for element to click"
            },
            "wait_time": {
              "type": "integer",
              "default": 1000,
              "description": "Wait time in milliseconds"
            },
            "force_click": {
              "type": "boolean",
              "default": false,
              "description": "Force click even if element not clickable"
            },
            "scroll_into_view": {
              "type": "boolean",
              "default": true,
              "description": "Scroll element into view before clicking"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            },
            "click_type": {
              "type": "string",
              "enum": [
                "left",
                "right"
              ],
              "default": "left",
              "description": "Type of click to perform"
            },
            "click_count": {
              "type": "integer",
              "default": 1,
              "minimum": 1,
              "description": "Number of clicks to perform"
            },
            "click_and_hold": {
              "type": "boolean",
              "default": false,
              "description": "Whether to click and hold"
            },
            "hold_duration": {
              "type": "integer",
              "default": 1000,
              "description": "Duration to hold click in milliseconds"
            }
          },
          "required": [
            "selector"
          ]
        }
      ]
    },
    "InputConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for input element"
            },
            "text": {
              "type": "string",
              "description": "Text to input"
            },
            "clear_first": {
              "type": "boolean",
              "default": true,
              "description": "Clear field before typing"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            },
            "scroll_into_view": {
              "type": "boolean",
              "default": true,
              "description": "Scroll element into view"
            }
          },
          "required": [
            "selector",
            "text"
          ]
        }
      ]
    },
    "NavigateConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "url": {
              "type": "string",
              "format": "uri",
              "description": "URL to navigate to"
            },
            "wait_for_load": {
              "type": "boolean",
              "default": true,
              "description": "Wait for page to load"
            },
            "take_screenshot": {
              "type": "boolean",
              "default": false,
              "description": "Take screenshot after navigation"
            }
          },
          "required": [
            "url"
          ]
        }
      ]
    },
    "WaitConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "wait_type": {
              "type": "string",
              "enum": [
                "duration",
                "element",
                "interactable"
              ],
              "default": "duration",
              "description": "Type of wait to perform"
            },
            "duration": {
              "type": "integer",
              "default": 3000,
              "description": "Duration to wait in milliseconds"
            },
            "selector": {
              "type": "string",
              "description": "CSS selector for element to wait for"
            },
            "timeout": {
              "type": "integer",
              "default": 10000,
              "description": "Maximum time to wait in milliseconds"
            },
            "wait_for_interactable": {
              "type": "boolean",
              "default": false,
              "description": "Wait for element to be interactable"
            },
            "fallback_to_duration": {
              "type": "boolean",
              "default": true,
              "description": "Fallback to duration wait if element wait fails"
            },
            "fallback_duration": {
              "type": "integer",
              "default": 2000,
              "description": "Duration to wait if fallback triggered"
            }
          }
        }
      ]
    },
    "AssertionConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for element"
            },
            "assert_type": {
              "type": "string",
              "enum": [
                "exists",
                "visible",
                "text",
                "value",
                "attribute"
              ],
              "default": "exists",
              "description": "Type of assertion"
            },
            "expected_value": {
              "type": "string",
              "description": "Expected value for assertion"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            },
            "case_sensitive": {
              "type": "boolean",
              "default": false,
              "description": "Case sensitive comparison"
            },
            "partial_match": {
              "type": "boolean",
              "default": false,
              "description": "Allow partial text matching"
            }
          },
          "required": [
            "selector",
            "expectedValue"
          ]
        }
      ]
    },
    "ScreenshotConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "screenshot_type": {
              "type": "string",
              "enum": [
                "viewport",
                "fullPage",
                "element"
              ],
              "default": "viewport",
              "description": "Type of screenshot to capture"
            },
            "selector": {
              "type": "string",
              "description": "CSS selector for element screenshots"
            },
            "filename": {
              "type": "string",
              "default": "screenshot.png",
              "description": "Output filename"
            },
            "save_to_file": {
              "type": "boolean",
              "default": true,
              "description": "Save screenshot to file system"
            },
            "include_timestamp": {
              "type": "boolean",
              "default": true,
              "description": "Include timestamp in filename"
            },
            "format": {
              "type": "string",
              "enum": [
                "png",
                "jpg"
              ],
              "default": "png",
              "description": "Output format"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            },
            "scroll_into_view": {
              "type": "boolean",
              "default": true,
              "description": "Scroll element into view"
            },
            "full_page": {
              "type": "boolean",
              "default": false,
              "description": "Take full page screenshot"
            }
          }
        }
      ]
    },
    "FormField": {
      "type": "object",
      "properties": {
        "selector": {
          "type": "string",
          "description": "CSS selector to target form field"
        },
        "value": {
          "description": "Value to fill"
        },
        "image": {
          "type": "string",
          "description": "Optional screenshot path"
        },
        "name": {
          "type": "string",
          "description": "Human-readable field name"
        },
        "type": {
          "type": "string",
          "enum": [
            "text",
            "password",
            "email",
            "number",
            "tel",
            "textarea",
            "date",
            "time",
            "datetime-local",
            "checkbox",
            "radio",
            "select",
            "file"
          ],
          "default": "text",
          "description": "Type of form field"
        },
        "options": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/FormFieldOption"
          },
          "description": "Options for select/radio fields"
        },
        "checked": {
          "type": "boolean",
          "default": false,
          "description": "Whether checkbox is checked"
        },
        "multiple": {
          "type": "boolean",
          "default": false,
          "description": "Whether select allows multiple selections"
        }
      },
      "required": [
        "selector",
        "value"
      ]
    },
    "FormFieldOption": {
      "type": "object",
      "properties": {
        "value": {
          "type": "string",
          "description": "Option value"
        },
        "label": {
          "type": "string",
          "description": "Option label"
        }
      },
      "required": [
        "value",
        "label"
      ]
    },
    "FormFillConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "fields": {
              "type": "array",
              "items": {
                "$ref": "#/$defs/FormField"
              },
              "description": "Array of form field configurations"
            },
            "wait_for_elements": {
              "type": "boolean",
              "default": true,
              "description": "Wait for all form elements to be present"
            },
            "clear_first": {
              "type": "boolean",
              "default": true,
              "description": "Clear existing values before filling"
            },
            "submit_after_fill": {
              "type": "boolean",
              "default": false,
              "description": "Automatically submit form after filling"
            },
            "smart_field_detection": {
              "type": "boolean",
              "default": true,
              "description": "Automatically detect field types"
            }
          },
          "required": [
            "fields"
          ]
        }
      ]
    },
    "ApiCallConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "method": {
              "type": "string",
              "enum": [
                "GET",
                "POST",
                "PUT",
                "DELETE",
                "PATCH"
              ],
              "default": "GET",
              "description": "HTTP method"
            },
            "url": {
              "type": "string",
              "format": "uri",
              "description": "API endpoint URL"
            },
            "headers": {
              "type": "object",
              "additionalProperties": {
                "type": "string"
              },
              "description": "HTTP headers"
            },
            "body": {
              "type": "string",
              "description": "Request body"
            },
            "output_variable": {
              "type": "string",
              "default": "apiResponse",
              "description": "Variable to store response"
            },
            "timeout": {
              "type": "integer",
              "default": 30000,
              "description": "Request timeout in milliseconds"
            },
            "retry_count": {
              "type": "integer",
              "default": 0,
              "description": "Number of retries"
            },
            "parse_json": {
              "type": "boolean",
              "default": true,
              "description": "Parse response as JSON"
            },
            "validate_status": {
              "type": "boolean",
              "default": true,
              "description": "Validate HTTP status code"
            },
            "follow_redirects": {
              "type": "boolean",
              "default": true,
              "description": "Follow HTTP redirects"
            },
            "verify_ssl": {
              "type": "boolean",
              "default": true,
              "description": "Verify SSL certificates"
            },
            "basic_auth_username": {
              "type": "string",
              "description": "Basic auth username"
            },
            "basic_auth_password": {
              "type": "string",
              "description": "Basic auth password"
            }
          },
          "required": [
            "url"
          ]
        }
      ]
    },
    "DatabaseQueryConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "connection_string": {
              "type": "string",
              "description": "Database connection string"
            },
            "query": {
              "type": "string",
              "description": "SQL query to execute"
            },
            "output_variable": {
              "type": "string",
              "default": "queryResult",
              "description": "Variable to store result"
            },
            "log_query": {
              "type": "boolean",
              "default": true,
              "description": "Log the query being executed"
            },
            "validate_connection": {
              "type": "boolean",
              "default": true,
              "description": "Validate database connection"
            },
            "timeout": {
              "type": "integer",
              "default": 30000,
              "description": "Query timeout in milliseconds"
            }
          },
          "required": [
            "connectionString",
            "query"
          ]
        }
      ]
    },
    "DatabaseInsertConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "connection_string": {
              "type": "string",
              "description": "Database connection string"
            },
            "table": {
              "type": "string",
              "description": "Table name to insert into"
            },
            "data": {
              "type": "object",
              "description": "Data to insert (column-value pairs)"
            },
            "log_operation": {
              "type": "boolean",
              "default": true,
              "description": "Log the insert operation"
            },
            "validate_connection": {
              "type": "boolean",
              "default": true,
              "description": "Validate database connection"
            },
            "rollback_on_error": {
              "type": "boolean",
              "default": true,
              "description": "Rollback transaction on error"
            }
          },
          "required": [
            "connectionString",
            "table",
            "data"
          ]
        }
      ]
    },
    "FileUploadConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for file input"
            },
            "file_path": {
              "type": "string",
              "description": "Path to file to upload"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            },
            "scroll_into_view": {
              "type": "boolean",
              "default": true,
              "description": "Scroll element into view"
            },
            "validate_file": {
              "type": "boolean",
              "default": true,
              "description": "Validate file exists before upload"
            }
          },
          "required": [
            "selector",
            "filePath"
          ]
        }
      ]
    },
    "FileDownloadConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for download link"
            },
            "download_path": {
              "type": "string",
              "description": "Path to save downloaded file"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            },
            "validate_download": {
              "type": "boolean",
              "default": true,
              "description": "Validate download completed"
            },
            "overwrite_existing": {
              "type": "boolean",
              "default": false,
              "description": "Overwrite existing files"
            }
          },
          "required": [
            "selector",
            "downloadPath"
          ]
        }
      ]
    },
    "CustomCodeConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "code": {
              "type": "string",
              "description": "JavaScript code to execute"
            },
            "output_variable": {
              "type": "string",
              "default": "customResult",
              "description": "Variable to store result"
            },
            "log_execution": {
              "type": "boolean",
              "default": true,
              "description": "Log code execution"
            },
            "catch_errors": {
              "type": "boolean",
              "default": true,
              "description": "Catch and handle errors"
            },
            "timeout": {
              "type": "integer",
              "default": 30000,
              "description": "Execution timeout in milliseconds"
            }
          },
          "required": [
            "code"
          ]
        }
      ]
    },
    "SubflowConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "flow_id": {
              "type": "string",
              "description": "ID of flow to call"
            },
            "flow_name": {
              "type": "string",
              "description": "Name of flow to call"
            },
            "input_parameters": {
              "type": "array",
              "items": {
                "type": "object"
              },
              "description": "Input parameters for subflow"
            },
            "output_parameters": {
              "type": "array",
              "items": {
                "type": "object"
              },
              "description": "Output parameters from subflow"
            },
            "output_variable": {
              "type": "string",
              "default": "flowResult",
              "description": "Variable to store result"
            },
            "wait_for_completion": {
              "type": "boolean",
              "default": true,
              "description": "Wait for flow to complete"
            },
            "log_execution": {
              "type": "boolean",
              "default": true,
              "description": "Log flow execution"
            },
            "propagate_errors": {
              "type": "boolean",
              "default": true,
              "description": "Propagate errors from subflow"
            }
          },
          "required": [
            "flowId"
          ]
        }
      ]
    },
    "SendKeysConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for element to send keys to"
            },
            "keys": {
              "type": "string",
              "description": "Keys to send"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            }
          },
          "required": [
            "keys"
          ]
        }
      ]
    },
    "ScrollConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "direction": {
              "type": "string",
              "enum": [
                "up",
                "down",
                "left",
                "right"
              ],
              "default": "down",
              "description": "Scroll direction"
            },
            "distance": {
              "type": "integer",
              "default": 100,
              "description": "Scroll distance in pixels"
            },
            "selector": {
              "type": "string",
              "description": "Element to scroll (optional, defaults to window)"
            }
          }
        }
      ]
    },
    "AssertVisibleConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for element to check"
            },
            "timeout": {
              "type": "integer",
              "default": 5000,
              "description": "Timeout in milliseconds"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            }
          },
          "required": [
            "selector"
          ]
        }
      ]
    },
    "ClearInputConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for input element"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            }
          },
          "required": [
            "selector"
          ]
        }
      ]
    },
    "OpenNewTabConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "url": {
              "type": "string",
              "description": "URL to open in new tab"
            }
          },
          "required": [
            "url"
          ]
        }
      ]
    },
    "SwitchTabConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "tab_index": {
              "type": "integer",
              "minimum": 0,
              "description": "Tab index to switch to"
            },
            "tab_title": {
              "type": "string",
              "description": "Tab title to switch to (alternative to index)"
            }
          }
        }
      ]
    },
    "GoForwardConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {}
        }
      ]
    },
    "GoBackConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {}
        }
      ]
    },
    "RefreshConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {}
        }
      ]
    },
    "GetPageInfoConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "output_variable": {
              "type": "string",
              "default": "pageInfo",
              "description": "Variable to store page information"
            }
          }
        }
      ]
    },
    "JunctionConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "condition": {
              "type": "string",
              "description": "Condition to evaluate"
            },
            "true_path": {
              "type": "string",
              "description": "Path to take if condition is true"
            },
            "false_path": {
              "type": "string",
              "description": "Path to take if condition is false"
            }
          }
        }
      ]
    },
    "ConditionalConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "condition": {
              "type": "string",
              "description": "JavaScript condition to evaluate"
            },
            "then_actions": {
              "type": "array",
              "items": {
                "type": "object",
                "additionalProperties": true
              },
              "description": "Actions to execute if condition is true"
            },
            "else_actions": {
              "type": "array",
              "items": {
                "type": "object",
                "additionalProperties": true
              },
              "description": "Actions to execute if condition is false"
            }
          },
          "required": [
            "condition"
          ]
        }
      ]
    },
    "LoopConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "loop_type": {
              "type": "string",
              "enum": [
                "count",
                "condition",
                "foreach"
              ],
              "default": "count",
              "description": "Type of loop"
            },
            "count": {
              "type": "integer",
              "minimum": 1,
              "description": "Number of iterations (for count loops)"
            },
            "condition": {
              "type": "string",
              "description": "Condition to continue loop (for condition loops)"
            },
            "array_variable": {
              "type": "string",
              "description": "Variable containing array to iterate (for foreach loops)"
            },
            "item_variable": {
              "type": "string",
              "default": "item",
              "description": "Variable name for current item (for foreach loops)"
            },
            "actions": {
              "type": "array",
              "items": {
                "type": "object",
                "additionalProperties": true
              },
              "description": "Actions to execute in each iteration"
            },
            "max_iterations": {
              "type": "integer",
              "minimum": 1,
              "default": 100,
              "description": "Maximum iterations to prevent infinite loops"
            }
          },
          "required": [
            "actions"
          ]
        }
      ]
    },
    "DragAndDropConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "source_selector": {
              "type": "string",
              "description": "CSS selector for element to drag"
            },
            "target_selector": {
              "type": "string",
              "description": "CSS selector for drop target"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for elements to be present"
            }
          },
          "required": [
            "sourceSelector",
            "targetSelector"
          ]
        }
      ]
    },
    "CallToFlowConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "flow_id": {
              "type": "string",
              "description": "ID of flow to call"
            },
            "input_parameters": {
              "type": "object",
              "description": "Input parameters to pass to subflow",
              "additionalProperties": true
            },
            "output_variable": {
              "type": "string",
              "default": "flowResult",
              "description": "Variable to store result"
            },
            "wait_for_completion": {
              "type": "boolean",
              "default": true,
              "description": "Wait for subflow to complete"
            },
            "async": {
              "type": "boolean",
              "default": false,
              "description": "Execute subflow asynchronously"
            }
          },
          "required": [
            "flowId"
          ]
        }
      ]
    },
    "SwitchToFrameConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "frame_selector": {
              "type": "string",
              "description": "CSS selector or frame name/ID"
            },
            "frame_index": {
              "type": "integer",
              "minimum": 0,
              "description": "Frame index (alternative to selector)"
            }
          }
        }
      ]
    },
    "ExitFrameConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {}
        }
      ]
    },
    "SetViewportConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "viewport_type": {
              "type": "string",
              "enum": [
                "preset",
                "device",
                "responsive",
                "custom"
              ],
              "default": "custom",
              "description": "Type of viewport configuration"
            },
            "width": {
              "type": "integer",
              "minimum": 1,
              "description": "Viewport width in pixels"
            },
            "height": {
              "type": "integer",
              "minimum": 1,
              "description": "Viewport height in pixels"
            },
            "screen_size_preset": {
              "type": "string",
              "description": "Preset screen size name"
            },
            "device_name": {
              "type": "string",
              "description": "Device name for emulation"
            },
            "device_scale_factor": {
              "type": "number",
              "minimum": 0.1,
              "maximum": 5,
              "default": 1.0,
              "description": "Device scale factor"
            },
            "is_mobile": {
              "type": "boolean",
              "default": false,
              "description": "Emulate mobile device"
            },
            "has_touch": {
              "type": "boolean",
              "default": false,
              "description": "Enable touch events"
            },
            "is_landscape": {
              "type": "boolean",
              "default": false,
              "description": "Use landscape orientation"
            },
            "user_agent": {
              "type": "string",
              "description": "Custom user agent string"
            },
            "wait_after_resize": {
              "type": "boolean",
              "default": true,
              "description": "Wait after viewport resize"
            },
            "take_screenshot": {
              "type": "boolean",
              "default": false,
              "description": "Take screenshot after resize"
            },
            "preserve_cookies": {
              "type": "boolean",
              "default": false,
              "description": "Preserve cookies across viewport changes"
            },
            "preserve_local_storage": {
              "type": "boolean",
              "default": false,
              "description": "Preserve local storage across viewport changes"
            },
            "preserve_session_storage": {
              "type": "boolean",
              "default": false,
              "description": "Preserve session storage across viewport changes"
            }
          },
          "required": [
            "width",
            "height"
          ]
        }
      ]
    },
    "GetElementPropertiesConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "selector": {
              "type": "string",
              "description": "CSS selector for element"
            },
            "properties": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "text",
                  "value",
                  "class",
                  "id",
                  "tagName",
                  "innerHTML",
                  "outerHTML",
                  "attributes",
                  "rect",
                  "visible",
                  "enabled",
                  "selected"
                ]
              },
              "description": "Properties to retrieve"
            },
            "output_variable": {
              "type": "string",
              "default": "elementProps",
              "description": "Variable to store properties"
            },
            "wait_for_element": {
              "type": "boolean",
              "default": true,
              "description": "Wait for element to be present"
            }
          },
          "required": [
            "selector",
            "properties"
          ]
        }
      ]
    },
    "HandlePopupConfig": {
      "allOf": [
        {
          "$ref": "#/$defs/BaseActionConfig"
        },
        {
          "type": "object",
          "properties": {
            "action": {
              "type": "string",
              "enum": [
                "accept",
                "dismiss",
                "text"
              ],
              "default": "accept",
              "description": "Action to perform on popup"
            },
            "text": {
              "type": "string",
              "description": "Text to enter in prompt popup"
            },
            "wait_for_popup": {
              "type": "boolean",
              "default": true,
              "description": "Wait for popup to appear"
            },
            "timeout": {
              "type": "integer",
              "default": 5000,
              "description": "Timeout in milliseconds"
            }
          }
        }
      ]
    }
  }
}